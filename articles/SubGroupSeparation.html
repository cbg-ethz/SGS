<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SubGroupSeparation • SubGroupSeparation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SubGroupSeparation">
<meta property="og:description" content="SubGroupSeparation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SubGroupSeparation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SubGroupSeparation.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SubGroupSeparation</h1>
                        <h4 data-toc-skip class="author">Fritz M. Bayer</h4>
            
      
      
      <div class="hidden name"><code>SubGroupSeparation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="exact-and-approximate-inference-in-bayesian-networks-with-r">Exact and Approximate Inference in Bayesian Networks with R<a class="anchor" aria-label="anchor" href="#exact-and-approximate-inference-in-bayesian-networks-with-r"></a>
</h2>
<p>Bayesian networks are a fundamental tool in the world of machine learning and statistics and have recently gained popularity as a common model for causality. Here, we discuss efficient methods for inference in Bayesian networks and discuss how they can be applied to missing data problems.</p>
<p>Inference describes the calculation of the marginal probability <span class="math inline">\(P(v'|e)\)</span> of a fraction of variables <span class="math inline">\(v' \in V\)</span> conditioned on a (typically observed) fraction of variables <span class="math inline">\(e\)</span>. As an example, we might be interested in the probability that it rained given that the grass is wet, where <span class="math inline">\(v':=rain\)</span> and <span class="math inline">\(e:=wet\ grass\)</span>. A corresponiding directed acyclic graph (DAG) might look as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create random BN and label variables </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">myBayesNet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomBN.html">randomBN</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">myBayesNet</span><span class="op">@</span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rain"</span>, <span class="st">"sprinkler"</span>, <span class="st">"wet grass"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">myBayesNet</span><span class="op">)</span></span></code></pre></div>
<p><img src="SubGroupSeparation_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>What is the probability that it rained?</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define observed variables and calculate the probability</span></span>
<span><span class="va">myObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observed.vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rain"</span><span class="op">)</span>, observed.vals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/exactInference.html">exactInference</a></span><span class="op">(</span><span class="va">myBayesNet</span>,<span class="va">myObserved</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6645466</span></span></code></pre></div>
<p>With marginal probability we mean calculating the probability of multiple variables, e.g. rain and wet grass. What’s the probability of having rain and wet grass at the same time?</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define observed variables and calculate the marginal probability</span></span>
<span><span class="va">myObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observed.vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rain"</span>, <span class="st">"wet grass"</span><span class="op">)</span>, observed.vals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/exactInference.html">exactInference</a></span><span class="op">(</span><span class="va">myBayesNet</span>,<span class="va">myObserved</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4193774</span></span></code></pre></div>
<p>Instead of simulating a Bayesian network, we can also learn it from data. In the following example, we learn a the Bayesian network from the well-known “Asia dataset” and subsequently perform inference on that.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let's learn the Bayesian network from the "Asia dataset"</span></span>
<span><span class="va">asia_bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/learn_bn.html">learn_bn</a></span><span class="op">(</span><span class="va">Asia</span><span class="op">)</span></span>
<span><span class="co">#&gt; maximum parent set size is 2 </span></span>
<span><span class="co">#&gt; core space defined, score table are being computed </span></span>
<span><span class="co">#&gt; score tables completed, iterative MCMC is running </span></span>
<span><span class="co">#&gt; search space expansion 2</span></span>
<span><span class="fu"><a href="../reference/plot_bn.html">plot_bn</a></span><span class="op">(</span><span class="va">asia_bn</span><span class="op">)</span></span></code></pre></div>
<p><img src="SubGroupSeparation_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># now we can do the inference on the learned Bayesian network</span></span>
<span><span class="va">myObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observed.vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"D"</span><span class="op">)</span>, observed.vals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/exactInference.html">exactInference</a></span><span class="op">(</span><span class="va">asia_bn</span>, <span class="va">myObserved</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.49438</span></span></code></pre></div>
<p>Next, let’s consider a more high-dimensional problem. Assume, we have measured 100 genes and would like to know what the probability of 4 particular genes is. We will use both exact and approximate inference to get the marginal probability distribution. For approximate inference, we use the efficient SGS algorithm (default) and the famous loopy belief propagation algorithm as a reference.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create random BN and label variables </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">myBayesNet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/randomBN.html">randomBN</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">myBayesNet</span><span class="op">)</span></span></code></pre></div>
<p><img src="SubGroupSeparation_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># what's the probability of having rain and wet grass at the same time?</span></span>
<span><span class="co"># define observed variables and calculate marginal probability</span></span>
<span><span class="va">myObserved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>observed.vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span>,<span class="fl">40</span>,<span class="fl">44</span>,<span class="fl">47</span><span class="op">)</span>, observed.vals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/exactInference.html">exactInference</a></span><span class="op">(</span><span class="va">myBayesNet</span>,<span class="va">myObserved</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05815955</span></span>
<span><span class="fu"><a href="../reference/approxInference.html">approxInference</a></span><span class="op">(</span><span class="va">myBayesNet</span>,<span class="va">myObserved</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05759497</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Fritz Bayer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
