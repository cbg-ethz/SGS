<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Learn a network (structure and parameters) of a BN from a BNDataset (see the Details section)."><title>learn a network (structure and parameters) of a BN from a BNDataset. — learn.network • SGS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="learn a network (structure and parameters) of a BN from a BNDataset. — learn.network"><meta property="og:description" content="Learn a network (structure and parameters) of a BN from a BNDataset (see the Details section)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SGS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/SGS.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>learn a network (structure and parameters) of a <a href="BN-class.html">BN</a> from a <a href="BNDataset-class.html">BNDataset</a>.</h1>
      
      <div class="d-none name"><code>learn.network.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Learn a network (structure and parameters) of a <a href="BN-class.html">BN</a> from a <a href="BNDataset-class.html">BNDataset</a> (see the <code>Details</code> section).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">learn.network</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for BN</span></span>
<span><span class="fu">learn.network</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  algo <span class="op">=</span> <span class="st">"mmhc"</span>,</span>
<span>  scoring.func <span class="op">=</span> <span class="st">"BDeu"</span>,</span>
<span>  initial.network <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  ess <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  layering <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max.fanin <span class="op">=</span> <span class="fu"><a href="num.variables.html">num.variables</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  max.fanin.layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max.parents <span class="op">=</span> <span class="fu"><a href="num.variables.html">num.variables</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  max.parents.layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer.struct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cont.nodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.imputed.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use.cpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mandatory.edges <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for BNDataset</span></span>
<span><span class="fu">learn.network</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  algo <span class="op">=</span> <span class="st">"mmhc"</span>,</span>
<span>  scoring.func <span class="op">=</span> <span class="st">"BDeu"</span>,</span>
<span>  initial.network <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  ess <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  layering <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max.fanin <span class="op">=</span> <span class="fu"><a href="num.variables.html">num.variables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  max.fanin.layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max.parents <span class="op">=</span> <span class="fu"><a href="num.variables.html">num.variables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  max.parents.layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer.struct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cont.nodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.imputed.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use.cpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mandatory.edges <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>can be a <code><a href="BN-class.html">BN</a></code> or a <code><a href="BNDataset-class.html">BNDataset</a></code>. If <code>x</code> is a <code><a href="BN-class.html">BN</a></code>,
then also the <code>dataset</code> parameter must be given.</p></dd>


<dt>...</dt>
<dd><p>potential further arguments for methods.</p></dd>


<dt>y</dt>
<dd><p>a <code><a href="BNDataset-class.html">BNDataset</a></code> object, to be provided only if <code>x</code> is a <code><a href="BN-class.html">BN</a></code>.</p></dd>


<dt>algo</dt>
<dd><p>the algorithm to use. Currently, one among <code>sm</code> (Silander-Myllymaki), <code>mmpc</code>
(Max-Min Parent-and-Children), <code>mmhc</code> (Max-Min Hill Climbing, default), <code>hc</code>
(Hill Climbing) and <code>sem</code> (Structural Expectation Maximization).</p></dd>


<dt>scoring.func</dt>
<dd><p>the scoring function to use. Currently, one among
<code>BDeu</code>, <code>AIC</code>, <code>BIC</code>.</p></dd>


<dt>initial.network</dt>
<dd><p>network structure to be used as starting point for structure search.
Can take different values:
a <code>BN</code> object, a matrix containing the adjacency matrix of the structure of the network,
or the string <code>random.chain</code> to sample a random chain as starting point.</p></dd>


<dt>alpha</dt>
<dd><p>confidence threshold (only for <code>mmhc</code>).</p></dd>


<dt>ess</dt>
<dd><p>Equivalent Sample Size value.</p></dd>


<dt>bootstrap</dt>
<dd><p><code>TRUE</code> to use bootstrap samples.</p></dd>


<dt>layering</dt>
<dd><p>vector containing the layers each node belongs to.</p></dd>


<dt>max.fanin</dt>
<dd><p>maximum number of parents for each node (only for <code>hc</code>, <code>mmhc</code>).</p></dd>


<dt>max.fanin.layers</dt>
<dd><p>matrix of available parents in each layer (only for <code>sm</code> --
DEPRECATED, use <code>max.parents.layers</code> instead).</p></dd>


<dt>max.parents</dt>
<dd><p>maximum number of parents for each node (for <code>sm</code>, <code>hc</code>, <code>mmhc</code>).</p></dd>


<dt>max.parents.layers</dt>
<dd><p>matrix of available parents in each layer (only for <code>sm</code>).</p></dd>


<dt>layer.struct</dt>
<dd><p><code>0/1</code> matrix for indicating which layers can contain parent nodes
for nodes in a layer (only for <code>mmhc</code>, <code>mmpc</code>).</p></dd>


<dt>cont.nodes</dt>
<dd><p>vector containing the index of continuous variables.</p></dd>


<dt>use.imputed.data</dt>
<dd><p><code>TRUE</code> to learn the structure from the imputed dataset
(if available, a check is performed). Default is to use raw dataset</p></dd>


<dt>use.cpc</dt>
<dd><p>(when using <code>mmhc</code>) compute Candidate Parent-and-Children sets instead of 
starting the Hill Climbing from an empty graph.</p></dd>


<dt>mandatory.edges</dt>
<dd><p>binary matrix, where a <code>1</code> in cell <code>[i,j]</code>
indicates that an edge from node <code>i</code> to node <code>j</code> must be present
in the final network.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>new <code><a href="BN-class.html">BN</a></code> object with structure (DAG) and conditional probabilities
as learnt from the given dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Learn the structure (the directed acyclic graph) of a <code><a href="BN-class.html">BN</a></code> object according to a <code><a href="BNDataset-class.html">BNDataset</a></code>.
We provide five algorithms for learning the structure of the network, that can be chosen with the <code>algo</code> parameter.
The first one is the Silander-Myllym\"aki (<code>sm</code>)
exact search-and-score algorithm, that performs a complete evaluation of the search space in order to discover
the best network; this algorithm may take a very long time, and can be inapplicable when discovering networks
with more than 25--30 nodes. Even for small networks, users are strongly encouraged to provide
meaningful parameters such as the layering of the nodes, or the maximum number of parents -- refer to the 
documentation in package manual for more details on the method parameters.</p>
<p>The second method is the constraint-based Max-Min Parents-and-Children (<code>mmpc</code>), that returns the skeleton of the network.
Given the possible presence of loops, due to the non-directionality of the edges discovered, no parameter learning
is possible using this algorithm. Also note that in the case of a very dense network and lots of obsevations, the statistical evaluation
of the search space may take a long time. Also for this algorithm there are parameters that may need to be tuned,
mainly the confidence threshold of the statistical pruning. Please refer to the rest of this documentation for their explanation.</p>
<p>The third algorithm is another heuristic, the Hill-Climbing (<code>hc</code>). It can start from the complete space of possibilities
(default) or from a reduced subset of possible edges, using the <code>cpc</code> argument.</p>
<p>The fourth algorithm (and the default one) is the Max-Min Hill-Climbing heuristic (<code>mmhc</code>), that performs a statistical
sieving of the search space followed by a greedy evaluation, by combining the MMPC and the HC algorithms.
It is considerably faster than the complete method, at the cost of a (likely)
lower quality. As for MMPC, the computational time depends on the density of the network, the number of observations and
the tuning of the parameters.</p>
<p>The fifth method is the Structural Expectation-Maximization (<code>sem</code>) algorithm,
for learning a network from a dataset with missing values. It iterates a sequence of Expectation-Maximization (in order to ``fill in''
the holes in the dataset) and structure learning from the guessed dataset, until convergence. The structure learning used inside SEM,
due to computational reasons, is MMHC. Convergence of SEM can be controlled with the parameters <code>struct.threshold</code>
and <code>param.threshold</code>, for the structure and the parameter convergence, respectively.</p>
<p>Search-and-score methods also need a scoring function to compute an estimated measure of each configuration of nodes.
We provide three of the most popular scoring functions, <code>BDeu</code> (Bayesian-Dirichlet equivalent uniform, default),
<code>AIC</code> (Akaike Information Criterion) and <code>BIC</code> (Bayesian Information Criterion). The scoring function
can be chosen using the <code>scoring.func</code> parameter.</p>
<p>Structure learning sets the <code>dag</code> field of the <code>BN</code> under study, unless bootstrap or the <code>mmpc</code> algorithm
are employed. In these cases, given the possible presence of loops, the <code>wpdag</code> field is set.</p>
<p>In case of missing data, the default behaviour (with no other indication from the user)
is to learn the structure using <code>mmhc</code> starting from the raw dataset, using only the
available cases with no imputation.</p>
<p>In case of learning from a dataset containing observations of a dynamic system, <code><a href="learn.dynamic.network.html">learn.dynamic.network</a></code>
will be employed.</p> 
<p>Then, the parameters of the network are learnt using MAP (Maximum A Posteriori) estimation (when not using bootstrap or <code>mmpc</code>).</p>
<p>See documentation for <code><a href="learn.structure.html">learn.structure</a></code> and <code><a href="learn.params.html">learn.params</a></code> for more informations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>learn.structure learn.params learn.dynamic.network</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">mydataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="BNDataset-class.html">BNDataset</a></span><span class="op">(</span><span class="st">"data.file"</span>, <span class="st">"header.file"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># starting from a BN</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="BN-class.html">BN</a></span><span class="op">(</span><span class="va">mydataset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">learn.network</span><span class="op">(</span><span class="va">net</span>, <span class="va">mydataset</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># start directly from the dataset</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">learn.network</span><span class="op">(</span><span class="va">mydataset</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Fritz Bayer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

